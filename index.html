<html><head>
    <meta charset="utf-8">
    <title>The OAuth Bible</title>
    <link href="https://fonts.googleapis.com/css?family=Eczar:400,500,600,700|Fira+Sans:300,300i,400,400i,500,500i,600,600i,700,700i|Source+Code+Pro:400,500,600,700" rel="stylesheet">
    <link href="assets/css/index.css" rel="stylesheet" type="text/css">
    <link href="https://netdna.bootstrapcdn.com/font-awesome/3.2.1/css/font-awesome.min.css" rel="stylesheet">
  </head>
<body>
<a href="https://github.com/Mashape/mashape-oauth/blob/master/FLOWS.md"><img style="position: fixed; top: 0; right: 0; border: 0;z-index:50000" src="https://s3.amazonaws.com/github/ribbons/forkme_right_gray_6d6d6d.png" alt="Fork me on GitHub"></a>
  <section class="header">
    <div class=" container slim">
      <!-- Logo -->
      <a href="https://mashape.com/" id="logo"><img src="https://www.mashape.com/assets/images/logo.svg" width="145" height="35" alt="Logo"></a>

      <!-- Navigation -->
      <ul id="navigation" style="display: inline-block; width: auto;">
        <li><a href="http://blog.mashape.com/">Blog</a></li>
        <li class="active"><a href="https://oauthbible.com/">OAuth Bible</a></li>
        <li><a href="https://guardianjs.com">Guardian</a></li>
        <li><a href="https://unirest.io">Unirest</a></li>
        <li><a href="https://getkong.org">Kong</a></li>
        <li><a href="https://getgalileo.io">Galileo</a></li>
        <li><a href="https://gelato.io">Gelato</a></li>
      </ul>
    </div>

    <div class="clear"></div>
  </section>

  <section class="hero content container rounded">
    <header>
      <h1>The OAuth Bible</h1>

      <h3>By <a href="http://twitter.com/nijikokun">@nijikokun</a></h3>
    </header>
  </section>

  <section class="seperator foreword">
    <section class="container">
      <p>I tried to make this as understandable as possible for any party reading it which means that the wording, references, and terminology used may not reflect that of a technical paper or resource. Excuse me if you may for I wish all to understand this, and not just those with a degree in understanding technical jargon.</p>
    </section>
  </section>

  <section class="content container rounded">
    <nav class="toc" id="table-of-contents">
      <ol>
        <li><h4>Reference</h4>
          <ol>
            <li page="1"><a href="#terminology-reference">Terminology</a></li>
            <li page="5"><a href="#signed-requests">Signed Requests</a></li>
            <li page="50"><a href="#sources">Sources</a></li>
          </ol>
        </li>
        <li><h4>OAuth 1.0a</h4>
          <ol>
            <li page="10"><a href="#oauth-10a-one-legged">One Legged</a></li>
            <li page="15"><a href="#oauth-10a-two-legged">Two Legged</a></li>
            <li page="20"><a href="#oauth-10a-three-legged">Three Legged</a></li>
            <li page="25"><a href="#oauth-10a-echo">Echo</a></li>
            <li page="30"><a href="#oauth-10a-xauth">xAuth</a></li>
          </ol>
        </li>
        <li><h4>OAuth2</h4>
          <ol>
            <li page="35"><a href="#oauth-2-two-legged">Two-Legged</a></li>
            <li page="40"><a href="#oauth-2-three-legged">Three-Legged</a></li>
            <li page="45"><a href="#oauth-2-refresh-token">Refresh Token</a></li>
          </ol>
        </li>
      </ol>
      <div class="clear"></div>
    </nav>

    <section class="seperator" id="terminology-reference">
      <h1>Terminology / Reference <a href="#terminology-reference" class="permalink"><i class="icon-link"></i></a></h1>

      <ul class="nostyle padded definition">
          <li>Signed / Signature
              <ul>
                <li>String made up of several HTTP request elements in a single string.</li>
                <li>These include the <code data-title="HTTP Request Method (GET, POST, etc...). Custom methods must be encoded.">Request Method</code>  <code data-title="Seperator">&amp;</code>  <code data-title="Path and Query parts of the Requesting URL">URL</code>  <code data-title="Seperator">&amp;</code>  <code data-title="Protocol Parameters, Excluding <code>oauth_signature</code>. Normalized, sorted, and encoded.">Parameters</code>, which is then encrypted against the key which consists of: (<code>consumer_secret</code>  <code>&amp;</code>  <code>token_secret</code>). In some cases this may be the <strong>key</strong>, plaintext, or may use simply the <code>consumer_secret</code>, for RSA encryption.</li>
              </ul>
          </li>
          <li>Consumer Key
              <ul>
                  <li>Identifier string generated by API for use in OAuth 1.0 handshake. Equivalent to a username.</li>
              </ul>
          </li>
          <li>Consumer Secret
              <ul>
                  <li>Unique token generated for use in OAuth 1.0 handshake as an element of signature creation.</li>
              </ul>
          </li>
          <li>Nonce / UID
              <ul>
                  <li>Uniquely generated ID of a given length using the <span data-title="<code>a-Z0-9</code>">charset</span>, by default these are usually <code>32</code> characters long.</li>
              </ul>
          </li>
          <li>OAuth Token
              <ul>
                  <li>Token generated by the server upon signed request, can be either the <code>request_token</code> or <code>access_token</code> depending on which step in the flow you are on.</li>
              </ul>
          </li>
          <li>OAuth Token Secret
              <ul>
                  <li>This is a secret generally sent with the response for a certain token. Used for exchange, signature generation, or refreshing the <code>access_token</code>.</li>
              </ul>
          </li>
          <li>Query
              <ul>
                  <li>Part of the URL that contains key-value data invoked by the <code>?</code> symbol, the keys and values are seperated by the <code data-title="key=value">=</code> sign and each data-store is seperated by the <code>&amp;</code> symbol:</li>
                  <li>http://httpbin.org/<code>?query=looks&amp;like=this</code></li>
              </ul>
          </li>
          <li>Parameter / Argument
              <ul>
                  <li>These are snippets of information that have a name reference such as <code>oauth_token="helloWorld"</code> where <code>oauth_token</code> is the parameter or argument and <code>helloWorld</code> is the value.</li>
              </ul>
          </li>
          <li><span data-title="Signature Encryption Method">Plaintext</span>
              <ul>
                  <li id="terminology-plaintext">No encryption method used, Human Readable text such as this line.</li>
              </ul>
          </li>
          <li><span data-title="Signature Encryption Method">HMAC-SHA1</span> [<a href="http://en.wikipedia.org/wiki/Hash-based_message_authentication_code" target="_blank">W</a>]
              <ul>
                  <li id="terminology-hmac-sha1">Secure Hash Algorithm Method.</li>
              </ul>
          </li>
          <li><span data-title="Signature Encryption Method">RSA-SHA1</span> [<a href="http://en.wikipedia.org/wiki/RSA_(algorithm)" target="_blank">W</a>]
              <ul>
                  <li id="terminology-rsa-sha1">Secure Hash Algorithm coupled with a public and private key. You may have seen this being used for your Github account at one point, or when using SSH.</li>
              </ul>
          </li>
          <li>Service
              <ul>
                  <li>Provider of information, data-source, or supplying use. Twitter is an example of a service.</li>
              </ul>
          </li>
          <li>Signature Method
              <ul>
                  <li>OAuth Accepted Encryption method, one of the following: PLAINTEXT, HMAC-SHA1, and RSA-SHA1.</li>
              </ul>
          </li>
          <li>Value
              <ul>
                  <li>Information in relation to something such as a parameter.</li>
              </ul>
          </li>
          <li>URL / URI
              <ul>
                  <li>Location on the internet or resource locator.</li>
              </ul>
          </li>
      </ul>
    </section>

    <section class="seperator" id="signed-requests">
      <h1><a href="#table-of-contents" class="pull-right">TOC</a>
        Signed Requests
        <a href="#signed-requests" class="permalink"><i class="icon-link"></i></a>
      </h1>

      <section class="seperator blockquote">
        <h2>Note</h2>

        <p>This section is in regards to <strong>OAuth 1.0</strong></p>
      </section>

      <p>Signing requests is more than just the signature so in this section we will look at how the signature process should be handled and how each parameter should be used with references to flows.</p>

      <p>In this step the Application takes all the information it has gathered and generated and places it in a single location.There are two ways of transporting this information, through the <code>OAuth</code> header or <code>Query</code> string. I highly recommend going the header route for better security.</p>

      <p>Before we can generate this string we must gather all the required parameters and their values, some of these are used inside of the string directly and others in-directly through the encryption or encoding of the signature.</p>

      <h2>Signature Base String</h2>

      <p>Gathering the <code>Method</code> of the request, the <code>URL</code> of the request (or in the case of <code>OAuth Echo</code> the verify credentials uri) and the <code>Parameters</code> joined together by the <code>&amp;</code> symbol would look like this raw (example from <a href="https://dev.twitter.com/docs/auth/creating-signature" target="_blank">twitter</a>):</p>

      <pre><code>POST&amp;https%3A%2F%2Fapi.twitter.com%2F1%2Fstatuses%2Fupdate.json&amp;include_entities%3Dtrue%26oauth_consumer_key%3Dxvz1evFS4wEEPTGEFPHBog%26oauth_nonce%3DkYjzVBB8Y0ZFabxSWbWovY3uYSQ2pTgmZeNu2VS4cg%26oauth_signature_method%3DHMAC-SHA1%26oauth_timestamp%3D1318622958%26oauth_token%3D370773112-GmHxMAgYyLbNEtIKZeRNFsMKPR9EyMZeS9weJAEb%26oauth_version%3D1.0%26status%3DHello%2520Ladies%2520%252B%2520Gentlemen%252C%2520a%2520signed%2520OAuth%2520request%2521</code></pre>

      <h2>Signing Key</h2>

      <p>The <code>signature base</code> string is then encrypted with a salt called the <strong>signing key</strong> which is always a joining of the OAuth <code>Consumer Secret</code> and <code>Token Secret</code> once again by the <code>&amp;</code> character like so:</p>

      <pre><code>kAcSOqF21Fu85e7zjz7ZN2U4ZRhfV3WpwPAoE3Z7kBw<span data-title="seperator">&amp;</span>LswwdoUaIvS8ltyTt5jkRh4J50vUPVVHtR2YPi5kE</code></pre>

      <section class="seperator blockquote">
        <h2>Note</h2>

        <p>Sometimes in case of RSA Encryption and xAuth the signing key may only be the <code>Consumer Secret</code> with the <code>&amp;</code> symbol appended or not.</p>

        <p>For more insights check out the following lines, <a href="https://github.com/Mashape/mashape-oauth/blob/master/lib/oauth.js#L233" target="_blank">#233</a> &amp; <a href="https://github.com/Mashape/mashape-oauth/blob/master/lib/oauth.js#L283" target="_blank">#283</a> from the <code>mashape-oauth</code> node module.</p>
      </section>


      <h2>Encoding the Signature</h2>

      <p>At last, we are able to encode our signature using these two strings of information. If you check out the terminology section you would find that there are three ways we can do this. <span data-title="#terminology-plaintext">PLAINTEXT</span>, <span data-title="#terminology-hmac-sha1">HMAC</span>, and <span data-title="#terminology-rsa-sha1">RSA</span> Encryption. Each method is slightly different, and carry their own set of pros and cons.</p>

      <h3>PLAINTEXT</h3>

      <p>Here we ignore any encoding and simply pass along the <code>Signature Key</code> as human readable text.</p>


      <h3>HMAC-SHA1</h3>

      <p>This encoding method outputs our key into binary which we update our base with, which after this step gets Base64 encoded into it's final signature string:</p>

      <pre><code>tnnArxj06cWHq44gCs1OSKk/jLY=</code></pre>

      <h3>RSA-SHA1</h3>

      <p>On the more complex side of encoding and security we have the RSA method that we have to encode the generated <code>Private Key</code> against our <code>Signature Base</code>.</p>

      <section class="seperator blockquote">
        <h2>Note</h2>

        <p>For clarification on how to pass your private key check out line <a href="https://github.com/Mashape/mashape-oauth/blob/master/tests/oauth.js#L74" target="_blank">#74</a> from the <code>mashape-oauth</code> node module.</p>
      </section>

      <p>Then on the service side they verify the public key that was generated along-side the private key against the encoded string passed as <code>oauth_signature</code>.</p>

      <h2>OAuth Header</h2>

      <p>The OAuth header is a part of the signed request, it contains the <code>oauth_signature</code> and <code>oauth_signature_method</code> parameters and their values. It is a single string and separated generally by a comma (spaces are supported here by some services, stick to comma by default unless told otherwise by the service) and named <code>Authorization</code> with <code>OAuth</code> being the Bearer, in other flows this may change such as the Mac Bearer and other similar methods.</p>

      <p>The header itself is built up by all the <code>oauth_*</code> parameters sorted (by name, then some more <a href="https://github.com/Mashape/mashape-oauth/blob/master/lib/oauth.js#L111" target="_blank">complex things</a>). Here is an example taken from Twitter for getting a Request Token:</p>

<pre><code>POST /oauth/request_token HTTP/1.1
User-Agent: themattharris' HTTP Client
Host: api.twitter.com
Accept: */*
Authorization:
        OAuth oauth_callback="http%3A%2F%2Flocalhost%2Fsign-in-with-twitter%2F",
              oauth_consumer_key="cChZNFj6T5R0TigYB9yd1w",
              oauth_nonce="ea9ec8429b68d6b77cd5600adbbb0456",
              oauth_signature="F1Li3tvehgcraF8DMJ7OyxO4w9Y%3D",
              oauth_signature_method="HMAC-SHA1",
              oauth_timestamp="1318467427",
              oauth_version="1.0"</code></pre>

      <p>The <code>oauth_callback</code> is what twitter will invoke or respond to when the authentication step happens, some services tell you they have successfully confirmed this information with a <code>oauth_callback_confirmed</code> token (This should be the de-facto situation).</p>

      <p>Now, lets see the example response:</p>

<pre lang="bash">HTTP/1.1 200 OK
Date: Thu, 13 Oct 2011 00:57:06 GMT
Status: 200 OK
Content-Type: text/html; charset=utf-8
Content-Length: 146
Pragma: no-cache
Expires: Tue, 31 Mar 1981 05:00:00 GMT
Cache-Control: no-cache, no-store, must-revalidate, pre-check=0, post-check=0
Vary: Accept-Encoding
Server: tfe

oauth_token=NPcudxy0yU5T3tBzho7iCotZ3cnetKwcTIRlX0iwRl0&amp;
oauth_token_secret=veNRnAWe6inFuo8o2u8SLLZLjolYDmDP7SzL0YfYI&amp;
oauth_callback_confirmed=true</pre>

      <p>Great, <code>200</code> response with the <code>oauth_token</code>, <code>oauth_token_secret</code> and <code>oauth_callback_confirmed</code> parameters. This is perfect, now you can use the <code>oauth_token_secret</code> for creating your signature for the access token and <code>oauth_token</code> for authenticating the request.</p>

      <p>Generally, the <code>oauth_token</code> will be sent along as a query parameter <code>?oauth_token=[token goes here]</code> on the authenticate endpoint when doing a <code>3-Legged OAuth 1.0a</code> request which should give you back the <code>oauth_token</code> and <code>oauth_verifier</code> which then are used as well in your  Access Token request <a href="https://dev.twitter.com/docs/auth/implementing-sign-twitter" target="_blank">[19]</a>.</p>
    </section>

    <section class="seperator" id="oauth-10a-one-legged">
      <h1><a href="#table-of-contents" class="pull-right">TOC</a>
        OAuth 1.0a (One Leg)
        <a href="#oauth-10a-one-legged" class="permalink"><i class="icon-link"></i></a>
      </h1>

      <p>What is commonly known as two-legged is actually one legged, there is only one step, thus you are standing on one leg.</p>

      <section class="seperator blockquote bloodorange">
        <h2>Notice</h2>

        <p>Google requires a custom parameter that must be added to the query string of the url you are
      request called <code>xoauth_requester_id</code> [<a href="https://developers.google.com/google-apps/gmail/oauth_protocol#oauth_request_url" target="_blank">R</a>] and many others.</p>
      </section>
      <section class="seperator blockquote">
        <p>However, they have depricated OAuth 1.0a in favor of OAuth2. So make sure you are up to date on service authentication protocols and quirky requirements as the following information may not always be all that is required.</p>
      </section>

      <img src="http://puu.sh/2pe07.png" align="right">

      <ol>
        <li>Application sends a <strong>signed</strong> request to the Service giving it:
          <ul>
            <li><code>oauth_token</code> <em>Empty String</em></li>
            <li><code>oauth_consumer_key</code></li>
            <li><code>oauth_timestamp</code></li>
            <li><code>oauth_nonce</code></li>
            <li><code>oauth_signature</code></li>
            <li><code>oauth_signature_method</code></li>
            <li><code>oauth_version</code> <em>Optional</em></li>
          </ul>
        </li>
        <li>Service Validates and Grants Access to Resources.</li>
        <li>Application Utilizes Requested Resources</li>
      </ol>

      <p>This is probably the most quickest method of consuming an OAuth implementation however it comes with a few drawbacks on security which you can assume for yourself whether it is the best for your application.</p>
    </section>

    <section class="seperator" id="oauth-10a-two-legged">
      <h1><a href="#table-of-contents" class="pull-right">TOC</a>
        OAuth 1.0a (Two Legs)
        <a href="#oauth-10a-two-legged" class="permalink"><i class="icon-link"></i></a>
      </h1>

      <p>The real two-legged OAuth implementation, so lucrative it's like finding a diamond in the rough. Here we also avoid the user authentication step but follow the other flows of OAuth.</p>

      <img src="http://puu.sh/2peUI.png" align="right">

      <ol>
        <li>Application sends a <strong>signed</strong> request for a Request Token:
        <ul>
            <li><code>oauth_consumer_key</code></li>
            <li><code>oauth_timestamp</code></li>
            <li><code>oauth_nonce</code></li>
            <li><code>oauth_signature</code></li>
            <li><code>oauth_signature_method</code></li>
            <li><code>oauth_version</code> <em>Optional</em></li>
          </ul>
        </li>
        <li>Grants application Request Token:
          <ul>
            <li><code>oauth_token</code></li>
            <li><code>oauth_token_secret</code></li>
            <li>… Additional Parameters / Arguments</li>
          </ul>
        </li>
        <li>Exchange Request Token for Access Token, <strong>signed</strong> request
          <ul>
            <li><code>oauth_token</code> <em>Request Token</em></li>
            <li><code>oauth_consumer_key</code></li>
            <li><code>oauth_nonce</code></li>
            <li><code>oauth_signature</code></li>
            <li><code>oauth_signature_method</code></li>
            <li><code>oauth_version</code></li>
          </ul>
        </li>
        <li>Service grants Access Token &amp; Token Secret (same arguments generally as Step 2)</li>
        <li>Application uses <code>oauth_token</code> &amp; <code>oauth_token_secret</code> to access protected resources.</li>
      </ol>

      <p>Here is the actual flow of OAuth 1.0a 2-legged, here we can see the extra security measures in place to make sure a secure access connection has been made without bothering the user to authorize details.</p>
    </section>

    <section class="seperator" id="oauth-10a-three-legged">
      <h1><a href="#table-of-contents" class="pull-right">TOC</a>
        OAuth 1.0a (Three Legged)
        <a href="#oauth-10a-three-legged" class="permalink"><i class="icon-link"></i></a>
      </h1>

      <p>This flow is the full experience, the grand finale, the whole shebang. It's the full-flow of OAuth 1.0a, and the most complex, excluding the other two variants on it. The user interaction in the middle of the flow is usually what causes most confusion.</p>

      <img src="http://puu.sh/2pJ4y" align="right">

      <ol>
        <li>Application sends a <strong>signed</strong> request for a Request Token:
          <ul>
            <li><code>oauth_consumer_key</code></li>
            <li><code>oauth_timestamp</code></li>
            <li><code>oauth_nonce</code></li>
            <li><code>oauth_signature</code></li>
            <li><code>oauth_signature_method</code></li>
            <li><code>oauth_version</code> <em>Optional</em></li>
            <li><code>oauth_callback</code></li>
          </ul>
        </li>
        <li>Grants application Request Token:
          <ul>
            <li><code>oauth_token</code></li>
            <li><code>oauth_token_secret</code></li>
            <li><code>oauth_callback_confirmed</code></li>
            <li>… Additional Parameters / Arguments</li>
          </ul>
        </li>
        <li>Send user to authorize url using:
          <ul>
            <li><code>oauth_token</code></li>
          </ul>
        </li>
        <li>Prompts user to authorize / grant access</li>
        <li>User grants access</li>
        <li>Directs back to application with:
          <ul>
            <li><code>oauth_token</code></li>
            <li><code>oauth_verifier</code></li>
          </ul>
        </li>
        <li>Exchange Request Token / Verifier for Access Token, <strong>signed</strong> request
          <ul>
            <li><code>oauth_token</code> <em>Request Token;</em></li>
            <li><code>oauth_consumer_key</code></li>
            <li><code>oauth_nonce</code></li>
            <li><code>oauth_signature</code></li>
            <li><code>oauth_signature_method</code></li>
            <li><code>oauth_version</code></li>
            <li><code>oauth_verifier</code></li>
          </ul>
        </li>
        <li>Service grants Access Token &amp; Token Secret (same arguments generally as Step 2)</li>
        <li>Application uses <code>oauth_token</code> &amp; <code>oauth_token_secret</code> to access protected resources.</li>
      </ol>

      <section class="seperator blockquote bloodorange">
        <h2>Notice</h2>
        <p>On <strong>Step 6</strong> if the <code>oauth_verifier</code> has not been set, this is a failed OAuth 1.0a 3-Legged implementation and probably only requires the <code>oauth_token</code> to be sent. Rarely seen but they exist.</p>
      </section>

      <p>The most secure OAuth implementation so far, yet a little more complicated seeing as the user is a part of the handshake and must interact with interfaces during the transactions.</p>
    </section>

    <section class="seperator" id="oauth-10a-echo">
      <h1><a href="#table-of-contents" class="pull-right">TOC</a>
        OAuth 1.0a (Echo)
        <a href="#oauth-10a-echo" class="permalink"><i class="icon-link"></i></a>
      </h1>

      <p>Not necessarily the most common of OAuth implementations, but it exists. Created by Raffi from Twitter it uses two extra headers in the initial request token step to validate your user on their behalf by delegation.</p>

      <p>So essentially the <span data-title="Third-Party, Delegator">Service</span> will authenticate and verify the user against the originating service such as <span data-title="Origin Source">Twitter</span>.</p>

      <img src="http://puu.sh/2pKKr.png" align="right">

      <ol>
        <li>Application sends a signed request along with any data and:
          <ul>
            <li><code>oauth_consumer_key</code></li>
            <li><code>oauth_timestamp</code></li>
            <li><code>oauth_nonce</code></li>
            <li><code>oauth_signature</code></li>
            <li><code>oauth_signature_method</code></li>
            <li><code>oauth_version</code>  <em>Optional</em></li>
            <li><code>oauth_callback</code></li>
            <p>Along with two additional headers:</p>
            <li><code>X-Auth-Service-Provider</code></li>
            <li><code>X-Verify-Credentials-Authorization</code></li>
          </ul>
        </li>
        <li>Service takes the additional headers and validates against the Origin Service.</li>
        <li>Service then validates against given information and returns protected resource information. This could be storing an image, generating the url and returning that information.</li>
      </ol>
    </section>

    <section class="seperator" id="oauth-10a-xauth">
      <h1><a href="#table-of-contents" class="pull-right">TOC</a>
        OAuth 1.0a (xAuth)
        <a href="#oauth-10a-xauth" class="permalink"><i class="icon-link"></i></a>
      </h1>

      <p>xAuth is a way for desktop and mobile apps to get an OAuth access token from a user’s email and password, and it is still OAuth. So the third-party will ask for your credentials on the origin service to authenticate with.</p>

      <p>The xAuth process will give back read-only, or read-write access tokens. Some limitations can apply, as in the Twitter spec Direct Messages read access is not provided and you must use the <span data-title="OAuth 1.0a Three-Legged">full flow</span>.</p>

      <section class="seperator blockquote bloodorange">
        <h2>Notice</h2>
        <p>The user's credentials should never be kept by the application requesting them.</p>
      </section>

      <a href="http://puu.sh/2qnhm.png" target="_blank"><img src="http://puu.sh/2qneC.png" align="right" vspace="15px"></a>

      <ol>
        <li>Application Requests User Credentials</li>
        <li>Application creates signed request for Access Token:
          <ul>
            <li><code>oauth_consumer_key</code></li>
            <li><code>oauth_timestamp</code></li>
            <li><code>oauth_nonce</code></li>
            <li><code>oauth_signature</code></li>
            <li><code>oauth_signature_method</code></li>
            <li><code>oauth_version</code>  <em>Optional</em></li>
            <li><code>oauth_callback</code></li>
              <p>Along with additional parameters:</p>
            <li><code>x_auth_mode</code> = <code>client_auth</code></li>
            <li><code>x_auth_username</code></li>
            <li><code>x_auth_password</code></li>
            <li><code>x_auth_permission</code>  <em>Optional;</em> Scope of the requested token <a href="http://developer.vimeo.com/apis/advanced" target="_blank">[17]</a>
            </li>
          </ul>
        </li>
        <li>Service validates user details and grants Access Token
          <ul>
            <li><code>oauth_token</code></li>
            <li><code>oauth_token_secret</code></li>
          </ul>
        </li>
        <li>Application uses Access Token to retrieve protected resources.</li>
      </ol>
    </section>

    <section class="seperator" id="oauth-2-two-legged">
      <h1><a href="#table-of-contents" class="pull-right">TOC</a>
        OAuth 2 (Two Legged)
        <a href="#oauth-2-two-legged" class="permalink"><i class="icon-link"></i></a>
      </h1>

      <p>By far the easiest to explain, here we have what is called a <strong>Client Credentials</strong> authorization flow. <a href="https://tools.ietf.org/html/draft-ietf-oauth-v2-31#section-4.4" target="_blank">[26, 4.4]</a> Which is also basically just the <em>Resource Owner Password</em> flow without the username and password appended to the encoded query passed along as the body, unless the service states through the url in which case is wrong.</p>

      <section class="seperator blockquote skyblue">
        <h2>Info</h2>

        <p>If you are using basic, you will need to additionally pass along an <code>Authorization</code> header with the bearer type as <code>Basic</code> and as the value you use <code>client_id</code>  <code>:</code>  <code>client_secret</code> Base64 encoded.</p>

        <pre><code>Authorization: Basic Base64(client_id:client_secret)</code></pre>
      </section>

      <h3>Client Credentials</h3>

      <ol>
        <li>Application makes request to Service:
          <ul>
            <li><code>grant_type</code> = <code>client_credentials</code></li>
          </ul>
          <p>If you aren't using the <code>Authorization</code> header:</p>
          <ul>
            <li><code>client_id</code></li>
            <li><code>client_secret</code></li>
          </ul>
        </li>
        <li>Service responds with Access Token:
          <ul>
            <li><code>access_token</code></li>
            <li><code>expires_in</code></li>
            <li><code>token_type</code></li>
          </ul>
        </li>
      </ol>


      <h3>Implicit Grant</h3>

      <p>You will notice that we don't send the secret, this is actually the correct way of sending information; However, like all the other parts of OAuth there are services that don't follow this paradigm so in some cases it may be required. Also, the header should not be used in this case, and once again some services may completely ignore the specifications. Make sure to check the documentation of the service before assuming.</p>

      <ol>
        <li>Application makes request to Service:
          <ul>
            <li><code>response_type</code> = <code>token</code></li>
            <li><code>redirect_uri</code> This is a server-side Redirection URI hosted by the provider or yourself.</li>
            <li><code>scope</code></li>
            <li><code>state</code> <em>Optional</em></li>
            <li><code>client_id</code></li>
          </ul>
        </li>
        <li>User may need to authorize, this is not required, but we will assume they are granting access.
          <ul>
            <li><code>username</code></li>
            <li><code>password</code></li>
          </ul>
        </li>
        <li>Service will respond with the <code>access_token</code> inside of the <code>redirect_uri</code>, surprisingly enough inside of a <code>#hash</code> fragment (as some server side components cannot read this information).
          You may want to take time to extract other information that is sent along here such as:
          <ul>
            <li><code>state</code> <em>Optional;</em> If used in the prior step.</li>
          </ul>
        </li>
        <li>Application will then follow the Redirection URI without the hash fragment (detailed in the spec, I assume you must remove this with client-side scripting as it will send the hash if you don't).</li>
        <li>Redirection URI will respond with a Script / HTML Fragment or Page containing the access_token, and any other parameters you may need. (Spec is not specific on parameter or script details, Freedom!).</li>
      </ol>

      <h3>Resource Owner Password</h3>

      <p>Basically OAuth 1.0a Echo… without the signing and complications. Let's do this.</p>

      <ol>
        <li>Application request credentials, <em>shown below</em>, from resource owner (also known as the user).
          <ul>
            <li><code>username</code></li>
            <li><code>password</code></li>
          </ul>
        </li>
        <li>Application makes request to Service using the given credentials as a query string for the body:
          <ul>
            <li><code>grant_type</code> = <code>password</code></li>
            <li><code>username</code></li>
            <li><code>password</code></li>
            <p>It should look like this:</p>

            <pre><code>grant_type=password&amp;username=my_username&amp;password=my_password</code></pre>

            <p>If you aren't using the <code>Authorization</code> header, these must be passed as well:</p>
            <li><code>client_id</code></li>
            <li><code>client_secret</code></li>

            <p>Which would become:</p>
            <pre><code>grant_type=password&amp;username=my_username&amp;password=my_password&amp;client_id=random_string&amp;client_secret=random_secret</code></pre>
          </ul>
        </li>
        <li>Service responds with Access Token details and expiration information:
          <ul>
            <li><code>access_token</code></li>
            <li><code>expires_in</code></li>
            <li><code>token_type</code></li>
          </ul>
        </li>
      </ol>
    </section>

    <section class="seperator" id="oauth-2-three-legged">
      <h1><a href="#table-of-contents" class="pull-right">TOC</a>
        OAuth 2 (Three Legged)
        <a href="#oauth-2-three-legged" class="permalink"><i class="icon-link"></i></a>
      </h1>

      <p>OAuth2 three-legged cuts out a lot of clutter just like the two-legged, no longer are things so complex with signing your requests.</p>

      <section class="seperator blockquote junglegreen">
        <h2>Fun Fact</h2>

        <p>Scope by spec was to be space seperated (i.e. <code>user pull-request</code>) to which nobody followed and we are now left in a state of constant wonder as to what the next api we tackle uses.</p>
      </section>

      <ol>
        <li>Application redirects User to Service for Authorization:
          <ul>
            <li><code>client_id</code></li>
            <li><code>redirect_uri</code></li>
            <li><code>response_type</code>  <a href="http://tools.ietf.org/html/draft-ietf-oauth-v2-31#section-4.1.1" target="_blank">[20, 4.1.1]</a></li>
            <li><code>state</code>  <em>Optional;</em> Unique identifier to protect against CSRF <a href="http://blog.springsource.org/2011/11/30/10317/" target="_blank">[25]</a></li>
            <li><code>scope</code>  <em>Optional;</em> what data your application can access.</li>
            <p>Example Authorization URL (Not-Encoded for Readability):</p>

            <pre><code>https://oauth_service/login/oauth/authorize?client_id=3MVG9lKcPoNINVB&amp;redirect_uri=http://localhost/oauth/code_callback&amp;scope=user</code></pre>
          </ul>
        </li>
        <li>User logs into the Service and grants Application access.</li>
        <li>Service redirects User back to the <code>redirect_url</code> with:
          <ul>
            <li><code>code</code></li>
            <li><code>state</code></li>
          </ul>
        </li>
        <li>Application takes the <code>code</code> and exchanges it for an Access Token:
          <ul>
            <li><code>client_id</code></li>
            <li><code>client_secret</code></li>
            <li><code>code</code></li>
            <li><code>redirect_uri</code>  <em>Optional;</em> see <a href="http://tools.ietf.org/html/rfc6749#section-4.1.3" target="_blank">[20, 4.1.3]</a></li>
            <li><code>grant_type</code> = <code>"authorization_code"</code>  <a href="http://tools.ietf.org/html/rfc6749#section-4.1.3" target="_blank">[20, 4.1.3]</a></li>
          </ul>
        </li>
        <li>If <code>client_id</code> and <code>client_secret</code> are valid the Service will invoke a callback on <code>redirect_url</code> that contains an <code>access_token</code>:
          <ul>
            <li><code>access_token</code></li>
            <li><code>expires_in</code></li>
            <li><code>refresh_token</code></li>
          </ul>
        </li>
        <li>Application stores <code>access_token</code> to use in subsequent requests in various manners dependent on the Service.
          <ul>
            <li>Generally this value is stored in a session or cookie, and then placed into the request as an <code>Authorization: [Bearer] access_token</code> header string where <code>[Bearer]</code> is the Header Authorization Bearer Name it could be Bearer, OAuth, MAC,
              etc…</li>
          </ul>
        </li>
      </ol>
    </section>

    <section class="seperator" id="oauth-2-refresh-token">
      <h1><a href="#table-of-contents" class="pull-right">TOC</a>
        OAuth 2 (Refresh Token)
        <a href="#oauth-2-refresh-token" class="permalink"><i class="icon-link"></i></a>
      </h1>

      <p>In OAuth2 the <code>access_token</code> sometimes, which is most of the time, has a limited lifetime expectancy. We can assume by the <code>expires_in</code> parameter passed along at the Access Token response stage whether it will live forever or decay
        in a certain amount of time.</p>

      <p>If an expired token is used the Service will respond with a Session expired or Invalid response error. This means we must use the <code>refresh_token</code> along with a few other previously obtained parameters to generate a new one. A lot easier than
        the whole flow.</p>

      <ol>
        <li>Create request to Service Refresh Token URI:
          <ul>
            <li><code>grant_type</code> = <code>"refresh_token"</code></li>
            <li><code>scope</code>  <em>Optional;</em> Cannot have any new scopes not previously defined.</li>
            <li><code>refresh_token</code></li>
            <li><code>client_id</code></li>
            <li><code>client_secret</code></li>
          </ul>
        </li>
        <li>Service validates and responds with the following parameters:
          <ul>
            <li><code>access_token</code></li>
            <li><code>issued_at</code></li>
          </ul>
        </li>
      </ol>
    </section>

    <section class="seperator" id="sources">
      <h1><a href="#table-of-contents" class="pull-right">TOC</a>
        Sources
        <a href="#sources" class="permalink"><i class="icon-link"></i></a>
      </h1>

      <p>Here is a long, windy list of places where I tracked down specific information regarding certain legs or auth specification excluding the original RFC and it's revisions.</p>

      <ol>
        <li><a href="http://www.flickr.com/services/api/auth.oauth.html" target="_blank">Authorizing with OAuth</a> - Flickr Documentation</li>
        <li><a href="https://confluence.atlassian.com/display/BITBUCKET/OAuth+on+Bitbucket" target="_blank">OAuth on Bitbucket</a> - Bitbucket Documentation</li>
        <li><a href="https://dev.twitter.com/docs/auth/oauth" target="_blank">OAuth Documentation</a> - Twitter Documentation</li>
        <li><a href="http://2.bp.blogspot.com/-Va1Rp3-r898/TZiVh9xEJDI/AAAAAAAAAMw/8ImBIW_dXuY/s1600/OAuth-legs.png" target="_blank">OAuth Extended Flows</a>
        </li>
        <li><a href="https://code.google.com/p/oauth-php/wiki/ConsumerHowTo#Two-legged_OAuth" target="_blank">2-Legged OAuth</a> - OAuth-PHP</li>
        <li><a href="http://oauth.googlecode.com/svn/spec/ext/consumer_request/1.0/drafts/2/spec.html" target="_blank">OAuth for Consumer Requests</a>
        </li>
        <li><a href="http://term.ie/oauth/example/" target="_blank">OAuth Example</a> - term.ie</li>
        <li><a href="http://hueniverse.com/oauth/guide/" target="_blank">OAuth 1.0 Guide</a> - Heuniverse</li>
        <li><a href="http://oauth.net/core/diagram.png" target="_blank">OAuth 1.0a Diagram</a>
        </li>
        <li><a href="http://wiki.oauth.net" target="_blank">OAuth Wiki</a>
        </li>
        <li><a href="http://architects.dzone.com/articles/2-legged-oauth-oauth-10-and-20" target="_blank">2-Legged OAuth 1.0 &amp; 2.0</a> - DZone</li>
        <li><a href="https://developers.google.com/accounts/docs/OAuth" target="_blank">OAuth</a> &amp; <a href="https://developers.google.com/accounts/docs/OAuth2" target="_blank">OAuth2</a> - Google Documentation</li>
        <li><a href="http://blog.nerdbank.net/2011/06/what-is-2-legged-oauth.html" target="_blank">What is 2-legged OAuth?</a> - Nerdbank</li>
        <li><a href="http://en.wikipedia.org/wiki/OAuth#List_of_OAuth_service_providers" target="_blank">List of Service Providers</a> - Wikipedia</li>
        <li><a href="http://developers.mobypicture.com/documentation/authentication/oauth-echo/" target="_blank">OAuth Echo</a> - mobypicture</li>
        <li><a href="https://dev.twitter.com/docs/auth/oauth/oauth-echo" target="_blank">OAuth Echo</a> - Twitter</li>
        <li><a href="http://developer.vimeo.com/apis/advanced" target="_blank">Advanced API</a> - Vimeo Developer();</li>
        <li><a href="https://dev.twitter.com/docs/oauth/xauth" target="_blank">About xAuth</a> - Twitter xAuth Documentation</li>
        <li><a href="https://dev.twitter.com/docs/auth/implementing-sign-twitter" target="_blank">Implementing Sign-in</a> - Twitter Sign-in Documentation</li>
        <li><a href="http://tools.ietf.org/html/rfc6749" target="_blank">RFC6749</a> - IETF</li>
        <li><a href="http://developer.github.com/v3/oauth/" target="_blank">Web Application Flow</a> - Github OAuth2</li>
        <li><a href="http://www.salesforce.com/us/developer/docs/api_rest/Content/quickstart_oauth.htm" target="_blank">OAuth2 Quickstart</a> - Salesforce</li>
        <li><a href="https://developers.geoloqi.com/api/authentication" target="_blank">Authentication Mechanisms</a> - Geoloqi</li>
        <li><a href="http://www.salesforce.com/us/developer/docs/api_rest/Content/intro_understanding_web_server_oauth_flow.htm" target="_blank">Understanding Web Server OAuth Flow</a> - Salesforce</li>
        <li><a href="http://blog.springsource.org/2011/11/30/10317/" target="_blank">CSRF &amp; OAuth2</a> - Springsource</li>
        <li><a href="https://tools.ietf.org/html/draft-ietf-oauth-v2-31" target="_blank">OAuth v2-31</a> - IETF</li>
        <li><a href="http://techblog.hybris.com/2012/06/11/oauth2-resource-owner-password-flow/" target="_blank">Resource Owner Flow</a> - Hybris</li>
      </ol>
    </section>
  </section>

  <script type="text/javascript" async="" src="http://www.google-analytics.com/analytics.js"></script><script type="text/javascript" async="" src="http://www.google-analytics.com/analytics.js"></script><script type="text/javascript" async="" src="http://d2dq2ahtl5zl1z.cloudfront.net/analytics.js/v1/xopuyo7jf9/analytics.min.js"></script><script type="text/javascript" async="" src="http://www.google-analytics.com/analytics.js"></script><script type="text/javascript" async="" src="http://d2dq2ahtl5zl1z.cloudfront.net/analytics.js/v1/xopuyo7jf9/analytics.min.js"></script><script type="text/javascript" src="//mashape.github.io/notification-bar/embed.js" async="" defer=""></script>
  <script src="http://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.6.2/html5shiv.js"></script>
  <script src="http://cdnjs.cloudflare.com/ajax/libs/jquery/2.0.0/jquery.min.js"></script>
  <script src="assets/js/just.the.tip.js" charset="utf-8"></script>

  <script>
    $('[data-title]').each(function () {
      $(this).justTheTip().arrow(11).pos('top').attr(['data-title']);
    });

    $('.toc a,a.pull-right,a.permalink').click(function () {
      // Firefox & IE put the scrolltop at the html level.
      $('body,html').scrollTop($($(this).attr('href')).offset().top - 75);
      return false;
    });
  </script>

  <script type="text/javascript">
    var analytics=analytics||[];(function(){var e=["identify","track","trackLink","trackForm","trackClick","trackSubmit","page","pageview","ab","alias","ready","group"],t=function(e){return function(){analytics.push([e].concat(Array.prototype.slice.call(arguments,0)))}};for(var n=0;n<e.length;n++)analytics[e[n]]=t(e[n])})(),analytics.load=function(e){var t=document.createElement("script");t.type="text/javascript",t.async=!0,t.src=("https:"===document.location.protocol?"https://":"http://")+"d2dq2ahtl5zl1z.cloudfront.net/analytics.js/v1/"+e+"/analytics.min.js";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(t,n)};
    analytics.load("xopuyo7jf9");
  </script>

</body></html>